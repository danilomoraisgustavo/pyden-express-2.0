<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PyDen Express – Admin Panel</title>
    <!-- Importações de estilo (mantidas conforme original) -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/dataTables.bootstrap4.min.css" />
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <!-- Barra de navegação -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">
            <img src="logo.png" alt="PyDen Express" style="height:30px; vertical-align:middle;" />
            PyDen Express Admin
        </a>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <!-- Menu lateral -->
            <aside id="sidebar" class="col-lg-2 col-md-3 col-sm-4 bg-light py-3">
                <ul class="nav flex-column">
                    <li class="nav-item"><a class="nav-link active" href="#sectionUsers">Usuários</a></li>
                    <li class="nav-item"><a class="nav-link" href="#sectionPermissions">Permissões</a></li>
                    <li class="nav-item"><a class="nav-link" href="#sectionDevices">Dispositivos GPS</a></li>
                </ul>
            </aside>
            <!-- Conteúdo principal -->
            <main class="col-lg-10 col-md-9 col-sm-8 pt-3">
                <section id="sectionUsers">
                    <h2>Gerenciamento de Usuários</h2>
                    <table id="usersTable" class="table table-striped">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Permissão</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Exemplo de linha de usuário -->
                            <tr>
                                <td>João Silva</td>
                                <td>joao@example.com</td>
                                <td>Administrador</td>
                                <td>
                                    <button class="btn btn-sm btn-primary btn-edit-user" data-userid="1">Editar</button>
                                    <button class="btn btn-sm btn-danger btn-delete-user" data-userid="1">Excluir</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-success my-2" data-toggle="modal" data-target="#modalAddUser">Adicionar Usuário</button>
                    <!-- Modal: Adicionar Usuário -->
                    <div class="modal fade" id="modalAddUser" tabindex="-1" role="dialog" aria-labelledby="modalAddUserLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalAddUserLabel">Novo Usuário</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form id="formAddUser">
                                        <div class="form-group">
                                            <label for="newUserName">Nome:</label>
                                            <input type="text" class="form-control" id="newUserName" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="newUserEmail">Email:</label>
                                            <input type="email" class="form-control" id="newUserEmail" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="newUserRole">Permissão:</label>
                                            <select id="newUserRole" class="form-control">
                                                <option value="user">Usuário</option>
                                                <option value="admin">Administrador</option>
                                            </select>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                    <button type="button" class="btn btn-primary" id="saveNewUserBtn">Salvar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Modal: Editar Usuário (exemplo, estrutura pronta para uso) -->
                    <div class="modal fade" id="modalEditUser" tabindex="-1" role="dialog" aria-labelledby="modalEditUserLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <!-- Conteúdo do modal de edição de usuário será inserido via JS quando necessário -->
                            </div>
                        </div>
                    </div>
                </section>
                <section id="sectionPermissions" class="mt-5">
                    <h2>Gerenciamento de Permissões</h2>
                    <!-- Formulário de permissões -->
                    <form id="permissionsForm">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="permManageUsers" />
                            <label class="form-check-label" for="permManageUsers">Gerenciar Usuários</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="permManageDevices" />
                            <label class="form-check-label" for="permManageDevices">Gerenciar Dispositivos</label>
                        </div>
                        <!-- Outros checkboxes de permissões, conforme necessário -->
                        <button type="button" class="btn btn-primary mt-3" id="savePermissionsBtn">Salvar Permissões</button>
                    </form>
                </section>
                <section id="sectionDevices" class="mt-5">
                    <h2>Gerenciamento de Dispositivos GPS</h2>
                    <table id="devicesTable" class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome do Dispositivo</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Exemplo de linha de dispositivo -->
                            <tr>
                                <td>DEVICE123</td>
                                <td>Rastreador Veicular</td>
                                <td>Ativo</td>
                                <td>
                                    <button class="btn btn-sm btn-primary btn-edit-device" data-deviceid="DEVICE123">Editar</button>
                                    <button class="btn btn-sm btn-danger btn-delete-device" data-deviceid="DEVICE123">Excluir</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-success my-2" data-toggle="modal" data-target="#modalAddDevice">Adicionar Dispositivo</button>
                    <!-- Modal: Adicionar Dispositivo -->
                    <div class="modal fade" id="modalAddDevice" tabindex="-1" role="dialog" aria-labelledby="modalAddDeviceLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalAddDeviceLabel">Novo Dispositivo</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form id="formAddDevice">
                                        <div class="form-group">
                                            <label for="deviceName">Nome:</label>
                                            <input type="text" class="form-control" id="deviceName" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="deviceId">ID do Dispositivo:</label>
                                            <input type="text" class="form-control" id="deviceId" required />
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                    <button type="button" class="btn btn-primary" id="saveNewDeviceBtn">Salvar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Modal: Editar Dispositivo (estrutura vazia para preenchimento dinâmico) -->
                    <div class="modal fade" id="modalEditDevice" tabindex="-1" role="dialog" aria-labelledby="modalEditDeviceLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <!-- Conteúdo do modal de edição de dispositivo será inserido via JS -->
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
    <!-- Importações de scripts (mantidas conforme original) -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery.dataTables.min.js"></script>
    <script src="js/dataTables.bootstrap4.min.js"></script>
    <!-- Código JavaScript personalizado reestruturado -->
    <script>
        // Inicialização dos DataTables
        $(function() {
            $('#usersTable').DataTable({
                language: {
                    url: "//cdn.datatables.net/plug-ins/1.11.5/i18n/pt-BR.json"
                }
            });
            $('#devicesTable').DataTable({
                language: {
                    url: "//cdn.datatables.net/plug-ins/1.11.5/i18n/pt-BR.json"
                }
            });
        });
    </script>
    <script>
        // Função genérica para exclusão de itens (usuário ou dispositivo)
        function deleteItem(itemType, id) {
            if (confirm('Deseja realmente excluir este ' + itemType + '?')) {
                // Exemplo: chamada AJAX para deletar item no servidor
                // $.post('/delete/' + itemType, { id: id });
                // Remover a linha correspondente da tabela
                if (itemType === 'usuário') {
                    $('#usersTable').DataTable().row($('[data-userid="' + id + '"]').parents('tr')).remove().draw();
                } else if (itemType === 'dispositivo') {
                    $('#devicesTable').DataTable().row($('[data-deviceid="' + id + '"]').parents('tr')).remove().draw();
                }
            }
        }
        // Módulo: Gerenciamento de Usuários
        $(function() {
            $('#saveNewUserBtn').on('click', function() {
                var userData = {
                    nome: $('#newUserName').val().trim(),
                    email: $('#newUserEmail').val().trim(),
                    role: $('#newUserRole').val()
                };
                if (userData.nome && userData.email) {
                    // Exemplo: chamada AJAX para adicionar usuário
                    // $.post('/users/add', userData);
                    $('#modalAddUser').modal('hide');
                    $('#formAddUser')[0].reset();
                    // Atualizar tabela de usuários (exemplo estático)
                    $('#usersTable').DataTable().row.add([
                        userData.nome,
                        userData.email,
                        (userData.role === 'admin' ? 'Administrador' : 'Usuário'),
                        '<button class="btn btn-sm btn-primary btn-edit-user" data-userid="">Editar</button> ' +
                        '<button class="btn btn-sm btn-danger btn-delete-user" data-userid="">Excluir</button>'
                    ]).draw();
                }
            });
            $(document).on('click', '.btn-edit-user', function() {
                var userId = $(this).data('userid');
                // Exemplo: carregar dados do usuário e preencher modal de edição
                $('#modalEditUser').modal('show');
            });
            $(document).on('click', '.btn-delete-user', function() {
                var userId = $(this).data('userid');
                deleteItem('usuário', userId);
            });
        });
    </script>
    <script>
        // Módulo: Gerenciamento de Permissões
        $(function() {
            $('#savePermissionsBtn').on('click', function() {
                // Coletar estados das permissões
                var permissoes = {
                    manageUsers: $('#permManageUsers').prop('checked'),
                    manageDevices: $('#permManageDevices').prop('checked')
                };
                // Exemplo: salvar permissões via AJAX
                // $.post('/permissions/save', permissoes);
                console.log('Permissões salvas:', permissoes);
            });
        });
    </script>
    <script>
        // Módulo: Gerenciamento de Dispositivos
        $(function() {
            $('#saveNewDeviceBtn').on('click', function() {
                var deviceData = {
                    name: $('#deviceName').val().trim(),
                    id: $('#deviceId').val().trim()
                };
                if (deviceData.name && deviceData.id) {
                    // Exemplo: chamada AJAX para adicionar dispositivo
                    // $.post('/devices/add', deviceData);
                    $('#modalAddDevice').modal('hide');
                    $('#formAddDevice')[0].reset();
                    // Atualizar tabela de dispositivos (exemplo estático)
                    $('#devicesTable').DataTable().row.add([
                        deviceData.id,
                        deviceData.name,
                        'Ativo',
                        '<button class="btn btn-sm btn-primary btn-edit-device" data-deviceid="' + deviceData.id + '">Editar</button> ' +
                        '<button class="btn btn-sm btn-danger btn-delete-device" data-deviceid="' + deviceData.id + '">Excluir</button>'
                    ]).draw();
                }
            });
            $(document).on('click', '.btn-edit-device', function() {
                var deviceId = $(this).data('deviceid');
                // Exemplo: carregar dados do dispositivo e preencher modal de edição
                $('#modalEditDevice').modal('show');
            });
            $(document).on('click', '.btn-delete-device', function() {
                var deviceId = $(this).data('deviceid');
                deleteItem('dispositivo', deviceId);
            });
        });
    </script>
</body>
</html>
